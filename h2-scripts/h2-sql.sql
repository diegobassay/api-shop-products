
INSERT INTO PRODUCT (ID, CODE, WINE_TYPE, PRICE, HARVEST, PURCHASED_YEAR) VALUES (1, '1', 'Tinto', 229.99, '2017', 2018),(2, '2', 'Branco', 126.5, '2018', 2019),(3, '3', 'Rosé', 121.75, '2019', 2020),(4, '4', 'Espumante', 134.25, '2020', 2021),(5, '5', 'Chardonnay', 128.99, '2021', 2022),(6, '6', 'Tinto', 327.5, '2016', 2017),(7, '7', 'Branco', 125.25, '2017', 2018),(8, '8', 'Rosé', 120.99, '2018', 2019),(9, '9', 'Espumante', 135.5, '2019', 2020),(10, '10', 'Chardonnay', 130.75, '2020', 2021),(11, '11', 'Tinto', 128.99, '2017', 2018),(12, '12', 'Branco', 106.5, '2018', 2019),(13, '13', 'Rosé', 121.75, '2019', 2020),(14, '14', 'Espumante', 134.25, '2020', 2021),(15, '15', 'Chardonnay', 188.99, '2021', 2022),(16, '16', 'Tinto', 127.5, '2016', 2017),(17, '17', 'Branco', 125.25, '2017', 2018),(18, '18', 'Rosé', 120.99, '2018', 2019),(19, '19', 'Espumante', 135.5, '2019', 2020),(20, '20', 'Chardonnay', 130.75, '2020', 2021);

INSERT INTO CUSTOMER (ID, CPF, NAME) VALUES (1, '05870189179', 'Geraldo Pedro Julio Nascimento'),(2, '20623850567', 'Vitória Alícia Mendes'),(3, '04372012950', 'Teresinha Daniela Galvão'),(4, '85067950013', 'Gabriel Rafael Dias'),(5, '27737287426', 'Andreia Emanuelly da Mata'),(6, '03763001590', 'Natália Sandra da Cruz'),(7, '88901767767', 'Catarina Sebastiana Analu Almeida'),(8, '1051252612', 'Hadassa Daniela Sales'),(9, '20634031392', 'Kaique Danilo Alves'),(10, '74302668512', 'Pietra Antônia Brenda Silva'),(11, '022484638124', 'Maitê Kamilly Corte Real'),(12, '29457224965', 'Isis Isis Ramos'),(13, '824643755772', 'Fabiana Melissa Nunes'),(14, '96718391344', 'Ian Joaquim Giovanni Santos');

INSERT INTO PURCHASE (ID, CODE, QUANTITY, CUSTOMER_ID) VALUES (1, '1', 6, 1),(2, '15', 4, 1),(3, '10', 2, 1),(4, '5', 3, 1),(5, '2', 5, 1),(6, '1', 8, 2),(7, '14', 3, 3),(8, '20', 3, 3),(9, '4', 2, 3),(10, '17', 6, 4),(11, '19', 4, 4),(12, '5', 6, 5),(13, '4', 4, 5),(14, '3', 2, 5),(15, '17', 3, 5),(16, '13', 5, 5),(17, '14', 5, 5),(18, '6', 6, 6),(19, '4', 4, 6),(20, '16', 6, 7),(21, '2', 4, 7),(22, '19', 3, 8),(23, '17', 3, 8),(24, '12', 2, 8),(25, '8', 3, 9),(26, '3', 3, 10),(27, '19', 6, 11),(28, '15', 4, 11),(29, '18', 6, 12),(30, '1', 4, 12),(31, '18', 2, 13),(32, '10', 10, 13),(33, '15', 6, 14),(34, '14', 4, 14),(35, '3', 20, 14),(36, '17', 13, 14),(37, '2', 15, 14);

SELECT TOP 3 custumer.*, sum(purchase.quantity) AS quantity_total_products 
	FROM CUSTOMER custumer 
        INNER JOIN PURCHASE purchase ON custumer.id = purchase.customer_id 
        GROUP BY custumer.id, custumer.name 
        ORDER BY quantity_total_products DESC;